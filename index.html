
 <!DOCTYPE html>
 <html lang="es">
 <head>
   <meta charset="UTF-8">
  
   <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
   <title>Formulario y Tabla con API</title>
 </head>
 <body>

 


  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

  
  
 
   <script>
     const apiUrl = "https://memin.io/public/api/users"; // URL de la API ficticia
 
       // Crear el formulario
       const formulario = document.createElement('form');
       formulario.classList.add('needs-validation');
       formulario.noValidate = true;
       formulario.id="miFormulario";

       const inputId=document.createElement('input')
       inputId.type="hidden";
       inputId.name="id";
       formulario.appendChild(inputId);

       // Crear campo de nombre
       const nombreGroup = document.createElement('div');
       nombreGroup.classList.add('mb-3');
       const nombreLabel = document.createElement('label');
       nombreLabel.setAttribute('for', 'nombre');
       nombreLabel.classList.add('form-label');
       nombreLabel.innerText = 'Nombre';
       const nombreInput = document.createElement('input');
       nombreInput.setAttribute('type', 'text');
       nombreInput.classList.add('form-control');
       nombreInput.setAttribute('id', 'nombre');
       nombreInput.setAttribute('placeholder', 'Ingrese su nombre');
       nombreInput.required = true;
       nombreGroup.appendChild(nombreLabel);
       nombreGroup.appendChild(nombreInput);

       // Crear campo de correo
       const correoGroup = document.createElement('div');
       correoGroup.classList.add('mb-3');
       const correoLabel = document.createElement('label');
       correoLabel.setAttribute('for', 'correo');
       correoLabel.classList.add('form-label');
       correoLabel.innerText = 'Correo';
       const correoInput = document.createElement('input');
       correoInput.setAttribute('type', 'email');
       correoInput.classList.add('form-control');
       correoInput.setAttribute('id', 'correo');
       correoInput.setAttribute('placeholder', 'Ingrese su correo electrónico');
       correoInput.required = true;
       correoGroup.appendChild(correoLabel);
       correoGroup.appendChild(correoInput);

      
  
     const botonCrearActualizar = document.createElement('button');
         botonCrearActualizar.setAttribute('type', 'button');
         botonCrearActualizar.classList.add('btn', 'btn-primary');
         botonCrearActualizar.innerText = 'Crear/Actualizar';

         formulario.appendChild(nombreGroup);
         formulario.appendChild(correoGroup);
         formulario.appendChild(botonCrearActualizar);

    // Crear la tabla
    const tabla = document.createElement('table');
    tabla.classList.add('table', 'table-bordered');
 
      // Crear el encabezado
      const thead = document.createElement('thead');
      const encabezado = document.createElement('tr');
      encabezado.innerHTML = '<th>Id</th><th>Nombre</th><th>Correo</th><th>Acciones</th>';
      thead.appendChild(encabezado);

 
     const tbody = document.createElement("tbody");
     tbody.id = "tablaCuerpo";
 
     tabla.appendChild(thead);
     tabla.appendChild(tbody);
 
     document.body.appendChild(formulario);
     document.body.appendChild(tabla);
 
     let datos = []; // Almacena los datos cargados desde la API
 
     function inicializarTabla() {
       tbody.innerHTML = "";
 
       datos.forEach((dato, index) => {
         const fila = document.createElement("tr");
         fila.innerHTML = `
           <td>${dato.id}</td>
           <td>${dato.name}</td>
           <td>${dato.email}</td>
           <td>
             <button onclick="editar(${index})">Editar</button>
             <button onclick="eliminar(${dato.id})">Eliminar</button>
           </td>
         `;
         tbody.appendChild(fila);
       });
     }
 
     function cargarDatosDesdeAPI() {
       fetch(apiUrl)
         .then(response => response.json())
         .then(data => {
           // Almacena los datos cargados desde la API
           datos = data;
           inicializarTabla();
         })
         .catch(error => console.error("Error al cargar datos desde la API:", error));
     }
 
     // Función para agregar o actualizar un elemento
     function crearActualizarDato() {
       const nuevoDato = {
         id: inputId.value,
         name: nombreInput.value,
         email: correoInput.value
       };
 
       // URL de la API
       const urlApi = apiUrl + (nuevoDato.id ? `/${nuevoDato.id}` : '');
 
       // Opciones de la solicitud
       const opcionesSolicitud = {
         method: nuevoDato.id ? "PUT" : "POST", // Usa PUT para actualizaciones y POST para nuevas creaciones
         headers: {
           "Content-Type": "application/json"
         },
         body: JSON.stringify(nuevoDato)
       };
 
       // Realiza la solicitud
       fetch(urlApi, opcionesSolicitud)
         .then(response => response.json())
         .then(respuesta => {
           // Maneja la respuesta del servidor (puede ser necesario dependiendo de tu implementación)
           console.log("Respuesta del servidor:", respuesta);
           
           // Después de enviar datos, actualiza la tabla y realiza otras acciones si es necesario
           cargarDatosDesdeAPI();
         })
         .catch(error => console.error("Error al enviar datos al servidor:", error));
     }
      // Función para actualizar la tabla sin recargar la página
    function actualizarTabla() {
      inicializarTabla();
    }
 
     // ...
 
     // Evento de click para el botón Crear/Actualizar
     botonCrearActualizar.addEventListener("click", crearActualizarDato);    
 
     function editar(indice) {
       const dato = datos[indice];
       inputId.value = dato.id; // Actualiza el campo ID oculto
       nombreInput.value = dato.name;
       correoInput.value = dato.email;
     }
 
     function eliminar(id) {
       fetch(`${apiUrl}/${id}`, {
         method: 'DELETE',
       })
       .then(response => response.json())
       .then(data => {
         console.log('Dato eliminado:', data);
         cargarDatosDesdeAPI();
       })
       .catch(error => console.error('Error al eliminar el dato:', error));
     }
 
     window.addEventListener("DOMContentLoaded", () => {
       cargarDatosDesdeAPI();
 
       formulario.addEventListener("submit", event => {
         event.preventDefault();
 
         const nuevoDato = {
           id: inputId.value, // Toma el ID del campo oculto
           name: inputNombre.value,
           email: inputCorreo.value
         };
 
         
 
         // Después de agregar o actualizar, puedes volver a cargar los datos desde la API y actualizar la tabla
         cargarDatosDesdeAPI();
       });
     });
   </script>

   
   
 
 </body>
 </html>
 
